#  GU√çA DE ESTUDIO - Testing con Jasmine y Karma


 Las pruebas son c√≥digo que verifica que tu c√≥digo funciona correctamente.

---

## üìö ¬øQu√© Aprender√°s?

- ‚úÖ Qu√© son las pruebas unitarias y por qu√© son importantes
- ‚úÖ C√≥mo usar Jasmine (framework de testing)
- ‚úÖ C√≥mo usar Karma (ejecutor de pruebas)
- ‚úÖ Escribir tus primeras pruebas
- ‚úÖ Probar componentes React

---

## üéØ 1. ¬øQU√â SON LAS PRUEBAS UNITARIAS?

### Explicaci√≥n Simple

Imagina que construyes con LEGO. Antes de armar el castillo completo, verificas que cada pieza encaje bien. Las **pruebas unitarias** hacen lo mismo con el c√≥digo: verifican que cada parte funcione correctamente por separado.

### ¬øPor qu√© son importantes?

1. **Encuentran errores r√°pido**: Como revisar tu tarea antes de entregarla
2. **Te dan confianza**: Sabes que tu c√≥digo funciona
3. **Documentan el c√≥digo**: Explican qu√© hace cada funci√≥n
4. **Facilitan cambios**: Puedes modificar c√≥digo sin miedo a romperlo

### Ejemplo del Mundo Real

Cuando compras en l√≠nea:
- ‚úÖ ¬øEl bot√≥n "Agregar al Carrito" funciona?
- ‚úÖ ¬øSe suma el precio correctamente?
- ‚úÖ ¬øPuedes eliminar productos?

Cada una de estas funciones necesita pruebas.

---

## üîß 2. HERRAMIENTAS QUE USAREMOS

### Jasmine üå∏

**¬øQu√© es?**: Un framework para escribir pruebas.

**Piensa en Jasmine como**: Un idioma especial para decir "Espero que esto funcione as√≠"

**Ejemplo**:
```typescript
// En espa√±ol: "Espero que 2 + 3 sea igual a 5"
// En Jasmine:
expect(2 + 3).toBe(5);
```

### Karma üé≠

**¬øQu√© es?**: Un programa que ejecuta tus pruebas en navegadores reales (Chrome, Firefox, etc.)

**Piensa en Karma como**: El maestro que revisa si tus respuestas est√°n correctas.

---

## üìù 3. TU PRIMERA PRUEBA

### Estructura B√°sica

Toda prueba tiene esta estructura:

```typescript
describe('Nombre del grupo de pruebas', () => {
  it('debe hacer algo espec√≠fico', () => {
    // Tu c√≥digo de prueba aqu√≠
  });
});
```

- **describe**: Agrupa pruebas relacionadas (como una carpeta)
- **it**: Define una prueba individual (como un archivo)

### Ejemplo Real: Sumar N√∫meros

```typescript
// Funci√≥n que queremos probar
function sumar(a: number, b: number): number {
  return a + b;
}

// Prueba de la funci√≥n
describe('Funci√≥n sumar', () => {
  it('debe sumar dos n√∫meros correctamente', () => {
    const resultado = sumar(2, 3);
    expect(resultado).toBe(5);
  });
});
```

**¬øQu√© hace esta prueba?**
1. Llama a la funci√≥n `sumar(2, 3)`
2. Verifica que el resultado sea `5`
3. Si es 5: ‚úÖ Prueba pasa
4. Si no es 5: ‚ùå Prueba falla

---

## üé® 4. PATR√ìN AAA (Arrange-Act-Assert)

### Las 3 A's de Testing

Todas las pruebas siguen este patr√≥n:

```typescript
it('debe calcular el total', () => {
  // 1. ARRANGE (Preparar): Configura los datos
  const precio = 100;
  const cantidad = 2;
  
  // 2. ACT (Actuar): Ejecuta la acci√≥n
  const total = precio * cantidad;
  
  // 3. ASSERT (Verificar): Comprueba el resultado
  expect(total).toBe(200);
});
```

**Piensa en esto como una receta**:
1. **Arrange**: Re√∫ne los ingredientes
2. **Act**: Cocina el platillo
3. **Assert**: Prueba si sabe bien

---

## üîç 5. MATCHERS (COMPARADORES)

Los **matchers** son formas de comparar valores.

### Matchers M√°s Usados

#### toBe() - "Debe ser"
Compara valores simples (n√∫meros, textos, true/false)

```typescript
expect(5).toBe(5);                    // ‚úÖ Pasa
expect('hola').toBe('hola');          // ‚úÖ Pasa
expect(true).toBe(true);              // ‚úÖ Pasa
```

#### toEqual() - "Debe ser igual a"
Compara objetos y arrays completos

```typescript
expect({nombre: 'Juan'}).toEqual({nombre: 'Juan'});  // ‚úÖ Pasa
expect([1, 2, 3]).toEqual([1, 2, 3]);                // ‚úÖ Pasa
```

#### toBeTruthy() - "Debe ser verdadero"
```typescript
expect('texto').toBeTruthy();         // ‚úÖ Pasa
expect(1).toBeTruthy();               // ‚úÖ Pasa
expect(0).toBeTruthy();               // ‚ùå Falla (0 es falsy)
```

#### toBeFalsy() - "Debe ser falso"
```typescript
expect(0).toBeFalsy();                // ‚úÖ Pasa
expect('').toBeFalsy();               // ‚úÖ Pasa
expect(null).toBeFalsy();             // ‚úÖ Pasa
```

#### toBeGreaterThan() - "Debe ser mayor que"
```typescript
expect(10).toBeGreaterThan(5);        // ‚úÖ Pasa
expect(3).toBeGreaterThan(5);         // ‚ùå Falla
```

#### toBeLessThan() - "Debe ser menor que"
```typescript
expect(5).toBeLessThan(10);           // ‚úÖ Pasa
```

#### toContain() - "Debe contener"
```typescript
expect([1, 2, 3]).toContain(2);       // ‚úÖ Pasa
expect('Hola Mundo').toContain('Mundo'); // ‚úÖ Pasa
```

#### toBeDefined() - "Debe estar definido"
```typescript
let valor = 'algo';
expect(valor).toBeDefined();          // ‚úÖ Pasa

let sinDefinir;
expect(sinDefinir).toBeDefined();     // ‚ùå Falla
```

---

## üîÑ 6. BEFORE EACH (Antes de Cada Prueba)

### ¬øPor qu√© usarlo?

A veces necesitas los mismos datos en varias pruebas. En lugar de repetir c√≥digo, usa `beforeEach`.

### Ejemplo Sin beforeEach (‚ùå Repetitivo)

```typescript
describe('Producto', () => {
  it('debe tener nombre', () => {
    const producto = { nombre: 'Mouse', precio: 25000 };
    expect(producto.nombre).toBeDefined();
  });
  
  it('debe tener precio', () => {
    const producto = { nombre: 'Mouse', precio: 25000 }; // Repetido
    expect(producto.precio).toBeDefined();
  });
});
```

### Ejemplo Con beforeEach (‚úÖ Mejor)

```typescript
describe('Producto', () => {
  let producto: any;
  
  beforeEach(() => {
    // Se ejecuta ANTES de cada prueba
    producto = { nombre: 'Mouse', precio: 25000 };
  });
  
  it('debe tener nombre', () => {
    expect(producto.nombre).toBeDefined();
  });
  
  it('debe tener precio', () => {
    expect(producto.precio).toBeDefined();
  });
});
```

**Ventaja**: No repites c√≥digo y cada prueba empieza con datos limpios.

---

## üïµÔ∏è 7. SPIES (ESP√çAS)

### ¬øQu√© son?

Los **spies** son funciones falsas que registran informaci√≥n sobre c√≥mo fueron llamadas.

**Piensa en un spy como**: Una c√°mara de seguridad que registra:
- ¬øSe llam√≥ la funci√≥n?
- ¬øCon qu√© valores?
- ¬øCu√°ntas veces?

### Ejemplo: Bot√≥n que llama una funci√≥n

```typescript
describe('Bot√≥n Agregar al Carrito', () => {
  let mockOnClick: jasmine.Spy;
  
  beforeEach(() => {
    // Crear un spy (funci√≥n falsa)
    mockOnClick = jasmine.createSpy('onClick');
  });
  
  it('debe llamar onClick cuando se hace click', () => {
    // Simular el click
    mockOnClick();
    
    // Verificar que se llam√≥
    expect(mockOnClick).toHaveBeenCalled();
  });
  
  it('debe pasar el ID del producto', () => {
    const productoId = 123;
    
    // Simular click con argumento
    mockOnClick(productoId);
    
    // Verificar que se llam√≥ con el ID correcto
    expect(mockOnClick).toHaveBeenCalledWith(123);
  });
  
  it('debe contar cu√°ntas veces se llam√≥', () => {
    mockOnClick();
    mockOnClick();
    mockOnClick();
    
    expect(mockOnClick).toHaveBeenCalledTimes(3);
  });
});
```

---

## üõ†Ô∏è 8. PROBANDO EL PROYECTO TIENDA-TECH

### Estructura del Proyecto

```
src/
  components/
    ProductCard.tsx          ‚Üê Componente
    ProductCard.spec.tsx     ‚Üê Pruebas del componente
```

### Ejemplo: Pruebas de ProductCard

```typescript
import { Product } from '../types/Product';

describe('ProductCard Component', () => {
  let mockProduct: Product;
  let mockOnAddToCart: jasmine.Spy;
  
  // Preparar datos antes de cada prueba
  beforeEach(() => {
    mockProduct = {
      id: 1,
      name: 'Notebook Gamer',
      price: 999990,
      image: 'test.jpg',
      category: 'Notebooks',
      description: 'Potente notebook',
      stock: 5
    };
    
    mockOnAddToCart = jasmine.createSpy('onAddToCart');
  });
  
  // Prueba 1: Verificar que el producto tiene nombre
  it('debe tener un nombre definido', () => {
    expect(mockProduct.name).toBeDefined();
    expect(mockProduct.name).toBe('Notebook Gamer');
  });
  
  // Prueba 2: Verificar que el precio es v√°lido
  it('debe tener un precio mayor a cero', () => {
    expect(mockProduct.price).toBeGreaterThan(0);
  });
  
  // Prueba 3: Verificar el stock
  it('debe mostrar el stock disponible', () => {
    expect(mockProduct.stock).toBe(5);
  });
  
  // Prueba 4: Verificar stock bajo
  it('debe marcar stock bajo cuando es menor a 5', () => {
    const lowStockProduct = { ...mockProduct, stock: 3 };
    expect(lowStockProduct.stock).toBeLessThan(5);
  });
  
  // Prueba 5: Verificar callback
  it('debe llamar onAddToCart al agregar producto', () => {
    mockOnAddToCart(mockProduct);
    expect(mockOnAddToCart).toHaveBeenCalledWith(mockProduct);
  });
});
```

---

## üí™ 9. EJERCICIOS PR√ÅCTICOS

### Ejercicio 1: Tu Primera Prueba (F√°cil)

Crea una funci√≥n `multiplicar` y escribe 3 pruebas:

```typescript
// 1. Escribe la funci√≥n
function multiplicar(a: number, b: number): number {
  // TODO: Completa aqu√≠
}

// 2. Escribe las pruebas
describe('Funci√≥n multiplicar', () => {
  it('debe multiplicar dos n√∫meros positivos', () => {
    // TODO: Completa aqu√≠
  });
  
  it('debe retornar 0 cuando se multiplica por 0', () => {
    // TODO: Completa aqu√≠
  });
  
  it('debe multiplicar n√∫meros negativos', () => {
    // TODO: Completa aqu√≠
  });
});
```

<details>
<summary>üëâ Ver Soluci√≥n</summary>

```typescript
function multiplicar(a: number, b: number): number {
  return a * b;
}

describe('Funci√≥n multiplicar', () => {
  it('debe multiplicar dos n√∫meros positivos', () => {
    expect(multiplicar(3, 4)).toBe(12);
  });
  
  it('debe retornar 0 cuando se multiplica por 0', () => {
    expect(multiplicar(5, 0)).toBe(0);
  });
  
  it('debe multiplicar n√∫meros negativos', () => {
    expect(multiplicar(-2, -3)).toBe(6);
  });
});
```
</details>

---

### Ejercicio 2: Formatear Precio (Medio)

Crea una funci√≥n que formatee precios chilenos y pru√©bala:

```typescript
function formatearPrecio(precio: number): string {
  // TODO: Retornar formato "$1.000" para 1000
}

describe('formatearPrecio', () => {
  it('debe agregar el s√≠mbolo $', () => {
    // TODO: Completa
  });
  
  it('debe usar punto como separador de miles', () => {
    // TODO: Completa
  });
});
```

<details>
<summary>üëâ Ver Soluci√≥n</summary>

```typescript
function formatearPrecio(precio: number): string {
  return `$${precio.toLocaleString('es-CL')}`;
}

describe('formatearPrecio', () => {
  it('debe agregar el s√≠mbolo $', () => {
    const resultado = formatearPrecio(1000);
    expect(resultado).toContain('$');
  });
  
  it('debe usar punto como separador de miles', () => {
    expect(formatearPrecio(1000)).toBe('$1.000');
    expect(formatearPrecio(50000)).toBe('$50.000');
  });
});
```
</details>

---

### Ejercicio 3: Validar Stock (Medio)

```typescript
function tieneStock(producto: Product): boolean {
  // TODO: Retornar true si el stock > 0
}

describe('tieneStock', () => {
  it('debe retornar true cuando hay stock', () => {
    // TODO: Completa
  });
  
  it('debe retornar false cuando no hay stock', () => {
    // TODO: Completa
  });
});
```

<details>
<summary>üëâ Ver Soluci√≥n</summary>

```typescript
function tieneStock(producto: Product): boolean {
  return producto.stock > 0;
}

describe('tieneStock', () => {
  it('debe retornar true cuando hay stock', () => {
    const producto = { stock: 5 } as Product;
    expect(tieneStock(producto)).toBe(true);
  });
  
  it('debe retornar false cuando no hay stock', () => {
    const producto = { stock: 0 } as Product;
    expect(tieneStock(producto)).toBe(false);
  });
});
```
</details>

---

### Ejercicio 4: Calcular Total del Carrito (Avanzado)

```typescript
interface CartItem {
  precio: number;
  cantidad: number;
}

function calcularTotal(items: CartItem[]): number {
  // TODO: Sumar precio * cantidad de todos los items
}

describe('calcularTotal', () => {
  it('debe calcular el total de un item', () => {
    // TODO: Completa
  });
  
  it('debe calcular el total de m√∫ltiples items', () => {
    // TODO: Completa
  });
  
  it('debe retornar 0 para carrito vac√≠o', () => {
    // TODO: Completa
  });
});
```

<details>
<summary>üëâ Ver Soluci√≥n</summary>

```typescript
function calcularTotal(items: CartItem[]): number {
  return items.reduce((total, item) => total + (item.precio * item.cantidad), 0);
}

describe('calcularTotal', () => {
  it('debe calcular el total de un item', () => {
    const items = [{ precio: 100, cantidad: 2 }];
    expect(calcularTotal(items)).toBe(200);
  });
  
  it('debe calcular el total de m√∫ltiples items', () => {
    const items = [
      { precio: 100, cantidad: 2 },
      { precio: 50, cantidad: 1 }
    ];
    expect(calcularTotal(items)).toBe(250);
  });
  
  it('debe retornar 0 para carrito vac√≠o', () => {
    expect(calcularTotal([])).toBe(0);
  });
});
```
</details>

---

## üöÄ 10. EJECUTAR LAS PRUEBAS

### Paso 1: Instalar Dependencias

```bash
cd tienda-tech-jasmine
npm install
```

### Paso 2: Ejecutar las Pruebas

```bash
npm test
```

Esto abrir√° Chrome y ver√°s los resultados de las pruebas.

### Interpretando los Resultados

**‚úÖ Verde = Todas las pruebas pasaron**
```
‚úì debe sumar dos n√∫meros
‚úì debe formatear el precio
‚úì debe validar el stock
```

**‚ùå Rojo = Alguna prueba fall√≥**
```
‚úó debe multiplicar correctamente
  Expected 12 but got 11
```

---

## üìã 11. CHECKLIST DE BUENAS PR√ÅCTICAS

Al escribir pruebas, aseg√∫rate de:

- [ ] Usar nombres descriptivos: `debe calcular el total correctamente`
- [ ] Una prueba, una cosa: No probar todo junto
- [ ] Usar beforeEach para datos repetidos
- [ ] Probar casos l√≠mite: n√∫meros negativos, cero, arrays vac√≠os
- [ ] Usar el patr√≥n AAA (Arrange-Act-Assert)
- [ ] Mantener pruebas independientes: Una no debe depender de otra

---

## üéì 12. GLOSARIO DE T√âRMINOS

| T√©rmino | Significado | Ejemplo |
|---------|-------------|---------|
| **Test** | Prueba individual | `it('debe sumar', () => {})` |
| **Suite** | Grupo de pruebas | `describe('Calculadora', () => {})` |
| **Matcher** | Comparador | `toBe()`, `toEqual()` |
| **Spy** | Funci√≥n falsa que registra llamadas | `jasmine.createSpy()` |
| **Mock** | Objeto simulado | Similar a spy |
| **Assertion** | Verificaci√≥n | `expect(x).toBe(y)` |
| **AAA** | Arrange-Act-Assert | Patr√≥n de estructura |
| **beforeEach** | C√≥digo que se ejecuta antes de cada prueba | Preparar datos |

---

## ü§î 13. PREGUNTAS FRECUENTES

### ¬øCu√°ntas pruebas debo escribir?

**Respuesta**: Al menos una prueba por cada funcionalidad importante. Si una funci√≥n hace 3 cosas diferentes, escribe al menos 3 pruebas.

### ¬øQu√© debo probar primero?

**Respuesta**: Empieza con la l√≥gica m√°s importante:
1. Funciones de c√°lculo (precios, totales)
2. Validaciones (stock, formularios)
3. Interacciones del usuario (clicks, cambios)

### ¬øTodas las pruebas deben pasar?

**S√≠**, todas las pruebas deben estar en verde (‚úÖ) antes de considerar que tu c√≥digo est√° listo.

### ¬øQu√© hago si una prueba falla?

1. Lee el mensaje de error
2. Identifica qu√© esperaba la prueba
3. Verifica tu c√≥digo
4. Corrige el error
5. Vuelve a ejecutar

---

## üìö 14. RECURSOS PARA APRENDER M√ÅS

### Documentaci√≥n Oficial
- [Jasmine](https://jasmine.github.io/) - Framework de testing
- [Karma](https://karma-runner.github.io/) - Test runner

### Videos en Espa√±ol
- Busca: "Pruebas unitarias JavaScript" en YouTube
- Busca: "Testing con Jasmine tutorial"

### Pr√°ctica
- Escribe pruebas para tus proyectos personales
- Participa en ejercicios de clase
- Revisa el c√≥digo del proyecto `tienda-tech-jasmine`

---

## ‚úÖ 15. AUTOEVALUACI√ìN

Responde estas preguntas para verificar tu aprendizaje:

1. ¬øQu√© es una prueba unitaria?
2. ¬øCu√°l es la diferencia entre `toBe()` y `toEqual()`?
3. ¬øPara qu√© sirve `beforeEach()`?
4. ¬øQu√© es un spy?
5. ¬øCu√°les son las 3 partes del patr√≥n AAA?

<details>
<summary>üëâ Ver Respuestas</summary>

1. **Prueba unitaria**: C√≥digo que verifica que una funci√≥n/componente funciona correctamente de forma aislada
2. **toBe vs toEqual**: `toBe()` compara valores simples, `toEqual()` compara el contenido de objetos/arrays
3. **beforeEach**: Ejecuta c√≥digo antes de cada prueba para preparar datos
4. **Spy**: Funci√≥n falsa que registra c√≥mo fue llamada
5. **AAA**: Arrange (preparar), Act (actuar), Assert (verificar)
</details>

---

## üéØ TU PR√ìXIMO PASO

1. ‚úÖ Lee esta gu√≠a completa
2. ‚úÖ Prueba los ejemplos en el proyecto
3. ‚úÖ Completa los ejercicios
4. ‚úÖ Escribe tus propias pruebas
5. ‚úÖ Pregunta a tu profesor si tienes dudas

**¬°Recuerda!**: Escribir pruebas es una habilidad que se desarrolla con la pr√°ctica. No te desanimes si al principio parece dif√≠cil. ¬°Sigue practicando! üí™

---

**‚ú® ¬°Mucho √©xito en tu aprendizaje de testing!**
